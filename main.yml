---
- name: Install and configure OpenVPN client on vpntv
  hosts: vpntv
  become: yes

  pre_tasks:
    - name: Load configuration (with defaults from example file).
      ansible.builtin.include_vars: "{{ item }}"
      loop:
        - example.config.yml
        - config.yml

    - name: Debian packages Upgrade
      apt:
        upgrade: yes
        update_cache: yes
        cache_valid_time: 3600
      when: ansible_facts.os_family == "Debian"

    - name: Arch packages Upgrade
      pacman:
        upgrade: yes
      when: ansible_facts.os_family == "Arch"

  tasks:
    - name: Configuring OpenVPN client
      ansible.builtin.import_tasks: tasks/ovpn-client.yml
      when: ovpnclient_enable

    - name: Configuring second wifi card as AP for TV
      ansible.builtin.import_tasks: tasks/config-wifi.yml
      when: wifi_enable

    - name: Installing WiFi card modules
      ansible.builtin.import_tasks: tasks/wifi-modules.yml
      when: wifi_enable

    - name: Configuring Ethernet interface as direct connection to TV
      ansible.builtin.import_tasks: tasks/config-ethernet.yml
      when: ethernet_enable
    